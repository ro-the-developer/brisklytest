Конвертер из данных из JSON в XLSX, реализован в виде консольной утилиты

**Требования:**

- php версии не ниже 7.4 с установленными модулями php-dom php-gd php-zip

**Установка:**  
Необходимо склонировать репозиторий или скачать и распаковать zip файл, перейти в папку с проектом
и выполнить команду

    composer install

(предварительно установив composer если он ещё не установлен).   
Использование композера в первую очередь продиктовано необходимостью использовать стороннюю библиотеку для формирования XLSX файлов.

**Использование:**

    php bin/xlsx_export.php -i имя_файла

где *имя_файла* - путь к файлу JSON с заказом. При этом итоговый файл будет сохранен в папке `var/output`

Также можно указать любое другое имя для итогового файла с помощью опции `-o --outfile`

Если указать параметры доступа к FTP, то файл будет сохранен на указанный FTP сервер:

    php bin/xlsx_export.php -i var/input/order.json -h="127.0.0.1" -u="anonymous" -p="" -d="/"

**Важно!** При запуске скрипта под Windows, слеш необходимо дублировать, то есть указыать как `-d="//"`   
Пример, с указанием другого итогового файла:

    php bin/xlsx_export.php -i var/input/order.json -o="ftp.xlsx" -h="127.0.0.1" -u="anonymous" -p="" -d="//"

Так же имеется специальная опция, `-s --strict_barcode_checking`. Если её задать, то неверный баркод будет вызывать ошибку.
По умолчанию же элементы с ошибочным баркодом игнорируются при конвертации.

**Полный список параметров:**

- `-i --infile`: путь к исходному файлу, обязательный параметр
- `-o --outfile`: путь к итоговому файлу или имя файла на FTP. по умолчнию `var/output/items.xlsx` / `items.xlsx` 
- `-h --ftp_host`: FTP хост, значения по умолчанию нет
- `-u --ftp_user`: имя пользователя FTP, по умолчанию `anonymous`
- `-p --ftp_pass`: пароль FTP, по умолчанию без пароля
- `-d --ftp_dir`: каталог FTP, по умолчанию в корень сервера
- `-s --strict_barcode_checking` флаг, задающий поведение при неверном баркоде.
  по умолчанию элементы с ошибочным баркодом игнорируются